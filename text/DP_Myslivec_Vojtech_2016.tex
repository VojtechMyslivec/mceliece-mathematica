% options:
% thesis=B bachelor's thesis
% thesis=M master's thesis
% czech thesis in Czech language
% slovak thesis in Slovak language
% english thesis in English language
% hidelinks remove colour boxes around hyperlinks

\documentclass[thesis=M,czech,hidelinks]{FITthesis}[2012/06/26]

\usepackage[utf8]{inputenc} % LaTeX source encoded as UTF-8

\usepackage{graphicx} %graphics files inclusion
\usepackage{amsmath} %advanced maths
\usepackage{amssymb} %additional math symbols

\usepackage{dirtree} %directory tree visualisation
% \usepackage{textcomp} % \textcopyleft

% % list of acronyms
% \usepackage[acronym,nonumberlist,toc,numberedsection=autolabel]{glossaries}
% \iflanguage{czech}{\renewcommand*{\acronymname}{Seznam pou{\v z}it{\' y}ch zkratek}}{}
% \makeglossaries
\newcommand{\tg}{\mathop{\mathrm{tg}}} %cesky tangens
\newcommand{\cotg}{\mathop{\mathrm{cotg}}} %cesky cotangens


\newtheorem{tvrzeni}{Tvrzení}
\newtheorem{definice}{Definice}
\newtheorem{veta}{Věta}

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% Hlavička
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

\department{Katedra počítačových systémů}
\title{Asymetrický šifrovací algoritmus McEliece}
\authorGN{Vojtěch} %(křestní) jméno (jména) autora
\authorFN{Myslivec} %příjmení autora
\authorWithDegrees{Bc. Vojtěch Myslivec} %jméno autora včetně současných akademických titulů
\supervisor{prof. Ing. Róbert Lórencz, CSc.}
%TODO
%\acknowledgements{Rodina, Lórencz, Kalvoda, Guth}
%TODO
\abstractCS{V~několika větách shrňte obsah a přínos této práce v~češtině. Po přečtení abstraktu by se čtenář měl mít čtenář dost informací pro rozhodnutí, zda chce Vaši práci číst.}
%TODO
\abstractEN{Sem doplňte ekvivalent abstraktu Vaší práce v~angličtině.}
\placeForDeclarationOfAuthenticity{V~Praze}
\declarationOfAuthenticityOption{4} %volba Prohlášení (číslo 1-6)
\keywordsCS{McEliece, asymetrická kryptografie, postkvantová kryptografie,
binární Goppa kódy, konečná tělesa, polynomy, Wolfram Mathematica}
\keywordsEN{McEliece, public-key cryptography, post-quantum cryptography, binary
Goppa codes, finite fields, polynomy, Wolfram Mathematica}




% % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% Dokument
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

\begin{document}

% \newacronym{CVUT}{{\v C}VUT}{{\v C}esk{\' e} vysok{\' e} u{\v c}en{\' i} technick{\' e} v Praze}
% \newacronym{FIT}{FIT}{Fakulta informa{\v c}n{\' i}ch technologi{\' i}}

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
\begin{introduction}
Tato práce se zabývá asymetrickým kryptosystémem \emph{McEliece}. Mezi největší
přednosti tohoto systému patří jeho odolnost vůči kvantovým počítačům a je tak
jedním z~vhodných kandidátů pro asymetrickou kryptografii pro postkvantovou
dobu.

%TODO
V~prvních kapitolách této práce jsou popsány nezbytné primitivy z~oblasti
matematiky a teorie kódování, které jsou potřeba pro pochopení a použití
kryptosystému McEliece. Jedná se především o~počítání s~\emph{konečnými tělesy}
a \emph{polynomy} (kapitola \ref{kap_telesa}) a binární \emph{Goppa} kódy
(kapitola \ref{kap_kody}).

Kryptosystému \emph{McEliece} se věnuje kapitola \ref{kap_mceliece}. Kromě
základního popisu generování klíčů a algoritmů pro šifrování a dešifrování je
probráno i \emph{Niederreiterovo} schéma -- \uv{úprava} kryptosystému
\emph{McEliece} pro získání \emph{digitálního podpisu}. Jsou ukázány slabiny,
nevýhody i možné útoky na kryptosystém McEliece a též zmíněna praktická varianta
systému odolná vůči těmto aspektům.

V~poslední části  práce je probrána implementace kryptosystému \emph{McEliece}
v~softwaru \emph{Wolfram Mathematica} včetně změřených časových % TODO a prostorových
složitostí (kapitola \ref{kap_implementace}),.

\end{introduction}

%\chapter{Cíl práce}

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
\chapter{Obecná algebra}\label{kap_telesa}
V~kapitole jsou probrány definice a algoritmy nutné pro práci s~\emph{konečnými
tělesy} a \emph{polynomy} nad konečným tělesem. V~práci se předpokládá
základních znalostí z~oblasti \emph{algebry}. Pro tato témata je doporučena
literatura \cite{FIT_MPI,FIT_MKY,FIT_LIN,FIT_BHW,Paar_Understanding} (kde lze též
najít většinu důkazů následujících vět).

\section{Základní termíny}
Pro ujasnění je uvedena definice tělesa:

\begin{definice}[Těleso]
    Nechť $M$ je neprázdná množina a $+$ a $\cdot$ binární operace\footnote{
Pro zjednodušení zápisu je $\cdot$ často vynecháváno.
    }. Struktura
    $T=\big(M, +, \cdot \big)$ se nazývá těleso, pokud platí
    \begin{enumerate}
        \item $\big(M, +\big)$ je \emph{komutativní grupa} (nazývána \emph{aditivní})
        \item $\big(M\setminus\{\mathit{0}\}, \cdot \big)$\footnote{
Prvek $\mathit{0}$ je \emph{nulový} (\emph{neutrální}) prvek \emph{aditivní grupy}.
            } je \emph{grupa} (nazývána
            \emph{multiplikativní})
        \item Platí (levý i pravý) \emph{distributivní zákon}:
            $$\forall a,b,c \in M : \big( a(b+c) = a b + a c \big) \land \big(
            (b+c)a = b a + c a \big) $$
    \end{enumerate}
\end{definice}

{\setlength{\parindent}{0cm}
\emph{Těleso}, které má konečný počet prvků, se nazývá \emph{konečné těleso}.
}

\begin{veta}
    Nechť $T$ je \emph{konečné těleso}, pak jeho počet prvků (\emph{řád}) je
    $p^n$, kde $p$ je prvočíslo a $n \in \mathbb{N} \land n \geq 1 $.
\end{veta}
%\begin{proof} TODO
%\end{proof}

Číslo $p$ se nazývá \emph{charakteristika}. Navíc platí, že \emph{všechna
konečná tělesa} se stejným počtem prvků jsou navzájem \emph{izomorfní}.
\emph{Konečné těleso} řádu $p^n$ je tedy dále označováno jako $GF(p^n)$
(z~anglického \emph{Gallois field}, dle francouzského matematika
\emph{Évariste Galois}).

\section{Reprezentace prvků}
Jak bude ukázáno dále, je vhodné prvky tělesa $GF(p^n)$ reprezentovat jako
\emph{polynomy} s~koeficienty z~množiny $\mathbb{Z}_p=\{0,1,\ldots,p-1\}$, tedy
prvek $a \in GF(p^n)$ lze zapsat:
$$ A(x) = \sum_{i=0}^{n-1} a_i x^i, a_i \in \mathbb{Z}_p $$

O~takovém polynomu říkáme, že je to \emph{polynom nad tělesem $GF(p)$ (řádu
maximálně $n-1$)}. Na prvek $a$ je též možné se dívat jako na vektor či $n$-tici
koeficientů~$a_i$:
$$ A(x) \cong a \cong (a_{n-1} a_{n-2} \ldots a_0) \cong a_{n-1} a_{n-2} \ldots a_0 $$

V~této práci se mezi těmito reprezentacemi prvků nadále volně přechází, jak
bude v~daném kontextu potřeba potřeba\footnote{
V~některých materiálech se používá i obráceného zápisu $(a_0 a_1 \ldots a_p-1)$.
}.

\section{Operace v~tělese $GF(p^n)$}
V~následujících sekcích jsou probrány operace potřebné pro počítání
s~tělesy $GF(p^n)$. Konkrétní zvolené algoritmy a jejich implementace
je detailně popsána v~kapitole \ref{kap_implementace}.

\subsection{Sčítání}
Sčítání v~tělese $GF(p^n)$ je definováno stejně jako sčítání polynomů, s~tím, že
sčítání jednotlivých koeficientů je prováděno \emph{modulo $p$} (v~tělese $GF(p)$:
$$ A(x) + B(x) = \sum a_i x^i + \sum b_i x^i = \sum \left|a_i + b_i\right|_p x^i $$


\subsection{Násobení}
Násobení v~tělese $GF(p^n)$ nelze provádět \uv{po složkách}, jako je tomu
u~sčítání. U~takto definované operace by většina prvků neměla (multiplikativní)
\emph{inverzi} a nejednalo by se tak o~\emph{těleso}.

Při násobení prvků se opět využije jejich reprezentace pomocí polynomů.
Výsledkem násobení pak je:
$$ A(x) \cdot B(x) = \sum_{i=0}^{n-1} a_i x^i \cdot \sum_{i=0}^{n-1} b_i x^i =
\sum_{i=0}^{2n-2} \left|\sum_{j+k=i} a_j \cdot b_k\right|_p x^i$$

Jak je naznačeno, násobení i sčítání koeficientů se provádí \emph{modulo} $p$
(v~tělese $GF(p)$.

Kvůli uzavřenosti násobení v~tělese je nutné zavést operaci $A(x) \mod P(x)$,
neboli zbytek po dělení polynomu $A(x)$ polynomem $P(x)$. Dále je třeba pro
určení tělesa $GF(p^n)$ určit \emph{ireducibilní} polynom, který bude použitý
při operaci násobení.

\begin{definice}
    Polynom $P(x)$ nad tělesem $GF(p)$ je \emph{ireducibilní} právě tehdy, když
    pro každé dva polynomy $A(x)$ a $B(x)$ nad $GF(p)$ platí:
    $$ A(x) \cdot B(x) = P(x) \Rightarrow \left( deg(A(x)) = 0 \right) \lor
    \left( deg(B(x)) = 0 \right)$$
\end{definice}

Neboli pro \emph{ireducibilní} polynom platí, že neexistuje rozklad na polynomy
nad $GF(p)$ stupně alespoň $1$.

\paragraph{Příklad:} Polynom $x^3+x+1$ je nad tělesem $GF(2)$ \emph{ireducibilní},
protože neexistuje jeho rozklad na polynomy stupně alespoň $1$. \\
Polynom $x^2+1$ není nad tělesem $GF(2)$ \emph{ireducibilní}, protože:
$$(x+1)\cdot(x+1) = x^2 + \left|1+1\right|_2x + 1 = x^2+1 $$

Nyní je možné zavést operaci násobení dvou prvků tělesa jako násobení dvou
polynomů \emph{modulo} \emph{zadaný ireducibilní} polynom:
$$ A(x) \cdot B(x) = \sum a_i x^i \cdot \sum b_i x^i =
\sum \left|\sum_{j+k=i} a_j \cdot b_k\right|_p x^i \mod P(x) $$


\paragraph{Poznámka} Pokud by zvolený $P(x)$ nebyl \emph{ireducibilní}, jednalo
by se o~\emph{okruh}, nikoliv o~\emph{těleso}, protože by neexistovala
\emph{multiplikativní inverze} pro některé prvky a navíc by i existovaly
tzv. \emph{dělitelé nuly}.


\subsection{Umocňování}
Pro rozšíření operací o~opakované násobení je vhodné zavést operaci umocňování.

\begin{definice}
    Pro prvek $a$ tělesa $T$ a číslo $n\in\mathbb{N}$ je operace
    umocňování definována následovně:
    \begin{align*}
        a^0     &= 1 \\
        a^n     &= \underbrace{a \cdot a \cdot \ldots \cdot a}_{\text{$n$-krát}} \\
        a^{-n}  &= \left(a^{-1}\right)^n
    \end{align*}
\end{definice}

Pro efektivní výpočet mocniny prvku je vhodné použít algoritmus
\emph{Square-and-Multiply}, kde se dílčí operace \uv{square} a \uv{multiply}
provádí operací $\cdot$ v~daném tělese $GF(p^n)$.

\subsection{Inverze}
\emph{Inverzi} v~\emph{grupě} lze obecně definovat následovně:
\begin{definice}[Inverze]
    Nechť $a$ je prvkem a $\mathbb{O}$ neutrálním prvkem \emph{grupy} \\
    $G = (M,\circ)$. Prvek $\bar{a}$ je \emph{inverzí} prvku $a$, pokud
    platí následující rovnice:
    $$ a \circ \bar{a} = \mathbb{O} $$
\end{definice}

\subsubsection{Aditivní inverze}
Inverze v~\emph{aditivní grupě} je značena znaménkem minus \uv{$-$} a je
z~definice velmi triviální:
$$ \left| A(x) + (-A(x)) \right|_p = 0 \Rightarrow
-A(x) = \sum \left|-a_i\right|_p x^i $$

Neboli je to aditivní inverze jednotlivých koeficientů \emph{modulo} $p$
(v~tělese $GF(p)$).


\subsubsection{Multiplikativní inverze}
Inverze v~\emph{multiplikativní grupě} je značena záporným exponentem
\uv{$^{-1}$} či symbolem dělení.
$$ \left| A(x) \cdot A(x)^{-1} \right|_p =
\left| \frac{A(x)}{A(x)} \right|_p = 1 $$

Tuto \emph{multiplikativní inverzi} je třeba počítat \emph{rozšířeným Euklidovým
algoritmem pro polynomy} (\emph{EEA}), či případně jinými algoritmy, jako je např.
\emph{algoritmus Itoh-Teechai-Tsujii} (\emph{ITT}) \cite{FIT_BHW,ITT}.

\emph{Rozšířený Euklidův algoritmus} \emph{pro polynomy}, stejně jako v~modulární
aritmetice (neboli pro tělesa $GF(p)$), stojí na nalezení \emph{Bézoutovy
rovnosti}. Pro výpočet \emph{EEA} je třeba výpočtu dělení polynomů se
zbytkem\footnote{
Někdy uváděno jako dlouhé dělení.
}.

%TODO příklad!

\section{Polynomy nad konečným tělesem}

% TODO
\emph{Prvotěleso}


% % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
\chapter{Lineární kódy}\label{kap_kody}

\section{Kódování}

\section{Lineární kódy}
\subsection{Hammingovy kódy}

\section{Goppa kódy}
\emph{Ireducibilní binární Goppa kódy}




% % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
\chapter{Kryptosystém McEliece}\label{kap_mceliece}

\section{Asymetrické šifrování McEliece}

\section{Niederreiterovo schéma}

\section{Bezpečnost algoritmů}
\subsection{Typy útoků}
\subsection{Slabiny systému}
\subsection{Existující útoky}
\subsection{Praktická varianta}
\emph{CCA2-odolná varianta}





% % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
\chapter{Implementace}\label{kap_implementace}
Pro implementaci kryptosystému \emph{McEliece} v~této práci byl zvolen software
\emph{Wolfram Mathematica} \cite{Mathematica}. Tento software byl zvolen hlavně
díky pohodlnosti některých matematických výpočtů a konstrukcí a také pro
přehlednost výstupů. %TODO

Při implementaci \emph{kryptosystému} se ukázaly nedostatky softwaru
\emph{Mathematica} a bylo nutné zpracovat problematiku (rozšířených)
\emph{konečných těles} a \emph{binárních Goppa kódů}. Tyto dvě oblasti byly
implementovány přímo v~softwaru \emph{Mathematica} tak, aby bylo možné jejich
pohodlné použití i v~jiných oblastech.

Celková práce byla rozdělena do třech ucelených částí -- (binární) \emph{konečná
tělesa}, (ireducibilní) \emph{binární Goppa kódy} a \emph{kryptosystém
McEliece} --, kde každá z~nich lze využít jako \emph{balík} či \emph{knihovna}
pro další výpočty. Následující kapitoly popisují jednotlivé části.

%\section{Wolfram Mathematica}

\section{Binární konečná tělesa}
Tato kapitola pojednává o~implementaci \emph{binárních konečných těles} včetně
jejich \emph{rozšíření}. Jsou zmíněny existující řešení v~softwaru
\emph{Mathematica}, zvolená implementace a popis implementovaných algoritmů.

\subsection{Existující řešení}
Pro operace s~\emph{konečnými tělesy} v~softwaru \emph{Mathematica} byly
prostudovány interní funkce pro operace s~polynomy a externí balík
\texttt{FiniteFields}. Vlastnosti těchto řešení jsou popsány v~následujících
kapitolách.

\subsubsection{Operace s~polynomy}
Software \emph{Mathematica} obsahuje funkce pro operace s~polynomy nad reálnými
(případně i komplexními) čísly. Většina těchto funkcí má volitelnou
\emph{možnost}\footnote{
Anglicky se tento termín v~softwaru \emph{Mathematica}
nazývá \emph{Option}.
} \emph{Modulus}, díky které lze zajistit, aby operace s~koeficienty byly prováděny
nad celými čísly \emph{modulo} zadané číslo $p$. Tímto způsobem je možné
implementovat operace nad tělesy $GF(p^n)$, nicméně je téměř nemožné
tímto způsobem implementovat \emph{rozšířená tělesa} -- polynomy nad polynomy.

Pro použití těchto funkcí (např. \texttt{ExtendedPolynomialGCD}, je třeba
polynomu v~úplném tvaru $\sum a_i x^i$ -- včetně $x^i$ s~tím, že $x$ musí být
nedefinovaný \emph{symbol}\footnote{
Jinými slovy proměnná, která nemá definovanou hodnotu.
}. Tento požadavek je celkem nepraktický, protože definování této proměnné
kdekoliv v~programu by vedlo na nemožnost použití těchto funkcí a udržovat si
prvky ve formě např. $x^6 + x^3 + x + 1$ místo $1001011$ není pohodlné.
Další nevýhoda použití polynomů je, že software \emph{Mathematica} vypisuje
polynomy od \emph{nejnižšího} členu po \emph{nejvyšší} (např. $1+x^2+x^4+x^7$),
což je obrácený zápis, než je v~technické literatuře zvykem.

\subsubsection{Balík \texttt{FiniteFields}}
\paragraph{Balík} \emph{Balík} v~softwaru \emph{Mathematica} je soubor obsahující
rozšiřující funkce, které standardně nejsou k~dispozici. Balík je možné načíst
pomocí funkcí \texttt{Needs}, či případně \emph{Get}.

Balík \texttt{FiniteFields} obsahuje základní operace pro práci s~tělesy
$GF(p^n)$. Prvky konečných těles jsou pak určené \emph{seznamem}\footnote{
\emph{Seznamem} se myslí struktura v~softwaru \emph{Mathematica} -- \emph{List}
} koeficientů a \emph{hlavičkou}, která určuje do jakého tělesa prvek patří.
Výhoda tohoto opatření je, že pro sčítání a násobení je pak možné využít
obyčejné symboly operací ($+$, $-$, $*$, $/$) a operace se automaticky provede
v~daném tělese.  Pro parametry $p$ a $n$ je určené jedno těleso $GF(p^n)$
(s~jedním konkrétním ireducibilním polynomem) a \emph{seznam} koeficientů prvku
se opět píše od nejnižšího řádu po nejvyšší (například polynom $x^3 + x + 1$
z~tělesa $GF(2^5)$ je zapsán jako $GF[2,5][\{1,1,0,1,0\}] $).

Funkce z~balíku \texttt{FiniteFields} nejsou dostatečně zdokumentovány, jak
je jinak v~softwaru \emph{Mathematica} zvykem. Nepodařilo se využít funkcí
z~tohoto balíku pro operace s~\emph{rozšířenými tělesy}.

\subsection{Zvolené řešení}
Existující řešení pro práci s~\emph{konečnými tělesy} se ukázala jako
nedostačující. Jejich hlavní nevýhodou je nemožnost použití při výpočtech
s~\emph{rozšířenými tělesy}. Proto bylo implementováno vlastní řešení pro práci
s~\emph{konečnými tělesy}.

Při implementaci operací nad \emph{konečnými tělesy} bylo dodržováno následující
jednotné rozhraní:

\begin{itemize}
    \item Prvky \emph{konečných těles} jsou reprezentovány \emph{seznamem}
        koeficientů od nejvyššího po nejnižší. \\ U~\emph{rozšířených těles}
        jsou koeficienty opět prvky konečných těles. \\
        Například polynom $x^3+x+1$ je reprezentován seznamem: $\{1,0,1,1\}$ \\
        a polynom $(y+1)x^2 + (y)$ je reprezentován:
        $\left\{\{1,1\},\{0,0\},\{1,0\}\right\}$

    \item Prvek (seznam koeficientů) může být libovolně dlouhý. V~případě
        potřeby se při výpočtu \emph{redukuje} (ireducibilním) polynomem nebo
        dorovná \emph{nulovými} koeficienty.

    \item Počet koeficientů vnitřních prvků (koeficientů) musí být vždy stejný. \\
        Například prvek $\{\{0,0\},\{1\},\{1,0\}\}$ není dovolený.

    \item Jednotlivým funkcím je kromě operandů předáván též i \emph{modul}
        skládající se z~odpovídajících (ireducibilních) polynomů, včetně
        charakteristiky tělesa. Tento \emph{modul} je definovaný následovně: \\
        Pro tělesa $GF(p^{n_1})$ je \emph{modul} složen z~(ireducibilního)
        polynomu $i_1$ stupně $n_1$ a dané charakteristiky $p$:
        $modul_1 = \left\{i_1,p\right\}$ \\
        Pro rozšířená tělesa se \emph{modul} skládá z~odpovídajícího
        \emph{polynomu} $i_k$ stupně $n_k$ nad tělesem
        $GF( {{p^{n_1}}^{\dots}}^{n_{k-1}} )$ a \emph{modulu vnitřního tělesa}: \\
        $modul_k = \left\{i_k,modul_{k-1}\right\}$.

    \item Všem funkcím se předávají nejdřív \emph{operandy} a poté \emph{modul}. \\
        Například pro prvky $a,b\in GF(p^{\ldots})$, $m\in\mathbb{N}$
        a odpovídající $modul$: \\
        \hspace*{0.6cm}$krat[a,b,modul]$ \\
        \hspace*{0.6cm}$inverze[a,modul]$ \\
        \hspace*{0.6cm}$mocnina[a,m,modul]$ \\
        \hspace*{0.6cm}\ldots

    \item Pro implementaci operací v~\emph{prvotělesech} (tělesech $GF(p^n)$)
        jsou použité vnitřní funkce softwaru \emph{Mathematica} pro práci
        s~\emph{polynomy}. Implementované funkce pro \emph{prvotělesa} tedy
        zpravidla obsahují převod ze \emph{seznamu} čísel na \emph{polynom},
        zavolání vnitřní funkce pro \emph{polynomy} a převodu zpět na
        \emph{seznam} koeficientů. Díky těmto vnitřním funkcím je docíleno
        rychlejšího výpočtu, než kdyby byla použita vlastní implementace nad
        \emph{seznamy} celých čísel.

    \item Pro implementaci operací v \emph{rozšířených tělesech} byly
        implementovány jednotlivé algoritmy operací (popsané níže), jelikož
        nebylo možné použít pro tyto operace vnitřní funkce softwaru
        \emph{Mathematica}. Funkce nad \emph{rozšířenými tělesy} zpravidla
        volají odpovídající funkce ve vnitřních tělesech (například násobení
        jednotlivých \emph{koeficientů}).

\end{itemize}

Tato pravidla umožňují pohodlný, jednotný a \emph{rekurzivní} přístup
k~jednotlivým prvkům a voláním funkcí (druhá složka \emph{modulu} je
\emph{modul} \emph{vnitřního tělesa}, prvky \emph{polynomu} jsou opět
\emph{polynomy}, \ldots).

\subsection{Implementace operací}
V~následujících kapitolách je popsána implementace hlavních operací
v~\emph{konečných tělesech} a použitých algoritmů. Pro další informace je
doporučeno nahlédnout do zdrojového kódu a příkladů použití.

V~níže uvedených pseudokódech se používá některých prvků ze syntaxe softwaru
\emph{Mathematica}:

\begin{table}[h!]
    \centering
    \begin{tabular}{ l  l }
        Zápis               & Význam                                            \\
        \hline
        \texttt{foo[bar]}   & Volání funkce \emph{foo} s argumentem \emph{bar}  \\
        \texttt{ham[[i]]}   & \emph{i}-tý prvek seznamu (pole) \emph{ham}       \\
    \end{tabular}
    \caption{Prvky syntaxe jazyka softwaru \emph{Mathematica}}
\end{table}

\subsubsection{Sčítání}
Jelikož operace sčítání se v~jakémkoliv \emph{tělese} provádí po jednotlivých
koeficientech \emph{modulo} $p$, je tato funkce jediná volána místo celkového
modulu pouze se zadanou charakteristikou $p$.

Pro \emph{rozšířená tělesa} funkce rekurzivně volá stejnou operaci sčítání na
jednotlivé koeficienty zadaných polynomů až na úroveň \emph{prvotěles} --
obyčejných jednorozměrných seznamů. Pro \emph{prvotělesa} funkce používá
obyčejné sčítání dvou seznamů modulo $p$.

\paragraph{Algoritmus:} TBA
%TODO
% GF(p^n)
%algoritmus plus[a,b,p]
%   return Mod[a+b,p]

% GF(q^n)
%algoritmus plus[a,b,p]
%   for (i in 1..Length[a])
%       c[[i]] = plus[a[[i]],b[[i]],p]
%   return c

\subsubsection{Redukce polynomu}
Redukce polynomu (neboli \emph{modulo} polynom) se používá ve většině dalších
funkcí. Tato funkce se volá se dvěma parametry -- prvkem $a$ a polynomem
(\emph{modulem}) $m$. Funkce vrátí zbytek polynomu $a$ po dělení polynomem $m$.

Redukce polynomu pro \emph{rozšířená tělesa} je inspirovaná \emph{Comb metodou}
z~\cite{Paar_Efficient}. K původnímu prvku $a$ se opakovaně přičítá (od
nejvyššího řádu) patřičný násobek \emph{polynomu} $m$ tak, aby se daný
koeficient $a_i$ rovnal nule (viz příklad níže).

Pro \emph{prvotělesa} se používá interní funkce \texttt{PolynomialMod}

\paragraph{Algoritmus:} TBA
\paragraph{Příklad:} TBA
% TODO příklad
%1000110111001 mod 10011A:

%1000110111001
%-------------
%10011
%   10011
%     10011
%      10011
%============
%        0111

\subsubsection{Násobení}
Výsledkem násobení dvou polynomů $a$ a $b$ stupně $n$ a $m$ je polynom $c$
stupně $n+m$. Násobení je implementováno tak, že k výsledku $c$ (na počátku
je to nulový polynom) se postupně přičítá skalární násobek polynomu $b$
koeficienty polynomu $a$, který je zároveň \emph{posunutý} o patřičný počet
pozic. Využívá se zde faktu, že násobení libovolného \emph{polynomu} $A(x)$
a $x^i$ je posunutí koeficientů polynomu $A$ o $i$ pozic doleva. Výsledný
polynom $c$ je následně \emph{redukován} zadaným modulem (viz výše).

Pro \emph{prvotělesa} se používá obyčejného násobení dvou \emph{polynomů}
a následné \emph{redukce} \emph{modulem}.

\paragraph{Algoritmus:} TBA
\paragraph{Příklad:} Příklad násobení polynomu $x^3+x+1$ polynomem
$x^4+x^2+2x+1$ (nad tělesem $GF(3)$):


$$
\arraycolsep=1pt
\begin{array}{r *{8}{l} }
    \multicolumn{9}{l}{1011 \cdot 10121:}   \\
     \hline
     \hline
        1 (x^0) &   &   &   &   & 1 & 0 & 1 & 1 \\
        2 (x^1) &   &   &   & 2 & 0 & 2 & 2 &   \\
        1 (x^2) &   &   & 1 & 0 & 1 & 1 &   &   \\
        0 (x^3) &   &   &   &   &   &   &   &   \\
        1 (x^4) & 1 & 0 & 1 & 1 &   &   &   &   \\
     \hline
                & 1 & 0 & 2 & 0 & 2 & 0 & 0 & 1
\end{array}
$$

\subsubsection{Inverze}
Výpočet multiplikativní \emph{inverze} je implementován pomocí \emph{rozšířeného
Euklidova algoritmu}. Tento algoritmus se často vizualizuje jako výpočet tabulky
po řádkách (viz níže). Ve skutečnosti však pro výpočet dalšího řádku stačí
pracovat s hodnotami dvou řádků předešlých. Proto si není nutné udržovat v
paměti celou tabulku, ale stačí si udržovat hodnoty dvou řádků a po výpočtu
třetího hodnoty posunout.

Výpočet hodnot dalšího řádku tabulky probíhá následovně:
\begin{itemize}
    \item Hodnoty předchozích řádků jsou:\\
        \hspace*{0.6cm}Polynomy $p_{i-2}$ a $p_{i-1}$ (na začátku inicializovány na
            ireducibilní polynom $m$ a \emph{prvek}, ke kterému je hledaná
            inverze). \\
        \hspace*{0.6cm}Polynomy $k_{i-2}$ a $k_{i-1}$ (na začátku inicializovány
            na $0$ a $1$, respektive \emph{nulový} a \emph{jednotkový
            polynom}).
    \item Je spočítán \emph{podíl} $q$ a zbytek $p_i$ pomocí tzv. \emph{dlouhého
        dělení} polynomu $p_{i-2}$ polynomem $p_{i-1}$.
    \item Je spočítán \emph{polynom} $k_i = k_{i-2} - q \cdot k_{i-1} $

    \item Tyto kroky se opakují, dokud není získán polynom $p_i$ stupně $0$
        (jinými slovy jediný prvek vnitřního tělesa).

    \item Výsledná \emph{inverze} se získá jako skalární násobek \emph{polynomu}
        $k_i$ inverzí (posledního) \emph{koeficientu} polynomu $p_i$\footnote{
Zde je vidět, že pro výpočet inverze v tělese $GF(q^n)$ je třeba vypočítat
inverzi v tělese $GF(q)$.
        }.
\end{itemize}

Inverze v \emph{prvotělese} je implementovaná pomocí interní funkce
\texttt{PolynomialExtendedGCD}.

\paragraph{Algoritmus:} TBA
%inverze[ prvek, modul ] :=
%    modul_{vnitrni} = modul[[2]]
%    A = modul[[1]] // polynom z modulu
%    B = prvek
%    while ( stupen[B] != 0 )
%        q = A/B; C = A mod B // výpočet pomocí dlouhého dělení v jednom kroku
%        k_C =  k_A - krat[ q, k_B ]
%
%        A = B; k_A = k_B
%        B = C; k_B = k_C
%
%    // výpočet koeficientu ve vnitřním tělese
%    koef = inverze[ Last[B], modul_{vnitrni} ]
%    return kratSkalar[ koef, k_C, modul_{vnitrni} ]
%

\paragraph{Příklad:} \emph{Rozšířený Euklidův algoritmus} pro výpočet
\emph{inverze} polynomu $x^3+x^2+1$ \emph{modulo} $x^6+x+1$ (nad tělesem
$GF(2)$):

\begin{center}
    \begin{tabular}{ r|r r r }
          Podíl &    Zbytek &       Koeficienty \\
        \hline
        \hline
                & $1000011$ &       $0$ &   $1$ \\
                &    $1101$ &       $1$ &   $0$ \\
        \hline
         $1110$ &     $101$ &   $-1110$ &   $1$ \\
           $11$ &      $10$ &   $10011$ & $-11$ \\
           $10$ &       $1$ & $-101000$ & $111$
    \end{tabular}
\end{center}
$ \Rightarrow \left|1101^{-1}\right|_{1000011} = 101000 $
\paragraph{Poznámka} Poslední sloupec tabulky se v algoritmu nepočítá, je zde
uveden pouze pro úplnost.


\subsubsection{Druhá mocnina}
Pro prvky tělesa s \emph{charakteristikou} $2$ Je výhodné implementovat funkci
\uv{na druhou} díky následujícímu tvrzení:


\begin{tvrzeni}
    Nechť $A=(a_n \dots a_2 a_1 a_0)$ je prvek tělesa
    s \emph{charakteristikou} $2$, potom platí:
    $$ A^2 = (a_n^2 0 \dots 0 a_2^2 0 a_1^2 0 a_0^2) $$
\end{tvrzeni}

\paragraph{Důkaz}
\begin{align*}
     A(x)    =& a_n x^n + \dots + a_2 x^2 + a_1 x + a_0
    {A(x)}^2 =& (a_n x^n + \dots + a_2 x^2 + a_1 x + a_0)\cdot(a_n x^n + \dots + a_2 x^2 + a_1 x + a_0) \\
             =& \quad a_n x^n   \cdot (a_n x^n + \dots + a_2 x^2 + a_1 x + a_0) + {} \\
                \vdots \\
              &  {} + a_2 x^2   \cdot (a_n x^n + \dots + a_2 x^2 + a_1 x + a_0) + {} \\
              &  {} + a_1 x \:  \cdot (a_n x^n + \dots + a_2 x^2 + a_1 x + a_0) + {} \\
              &  {} + a_0 \quad \cdot (a_n x^n + \dots + a_2 x^2 + a_1 x + a_0) \\
             =& \quad a_n^2 x^{2n}    + \dots + a_n a_2 x^{n+2} + a_n a_1 x^{n+1} + a_n a_0 x^n + {} \\
                \vdots \\
              &  {} + a_n a_2 x^{n+2} + \dots + a_2^2 x^4       + a_2 a_1 x^3     + a_2 a_0 x^2 + {} \\
              &  {} + a_n a_1 x^{n+1} + \dots + a_2 a_1 x^3     + a_1^2 x^2       + a_1 a_0 x   + {} \\
              &  {} + a_n a_0 x^n     + \dots + a_2 a_0 x^2     + a_1 a_0 x       + a_0^2            \\
             =& a_n^2 x^{2n} + \dots  + 2 ( a_3 a_0 + a_2 a_1 ) x^3  + ( 2 a_2 a_0 + a_1^2 ) x^2 + 2 a_1 a_0 x + a_0^2  \\
             =& a_n^2 x^{2n} + \dots + a_2 x^4 + a_1^2 x^2 + a_0^2  \\
         \cong& (a_n^2 0 \dots 0 a_2^2 0 a_1^2 0 a_0^2)
\end{align*}

S využitím tohoto tvrzení je realizace funkce na počítání druhé mocniny
triviální:
\begin{itemize}
    \item Provedení druhé mocniny všech koeficientů.
    \item Proložení koeficientů polynomu nulovými koeficienty.
    \item Redukování polynomem (viz výše).
\end{itemize}

\paragraph{Algoritmus:} TBA
%naDruhou[ a, modul ] := 
%    for (i in 1 .. Length[i])
%        a[[i]] = naDruhou[ a[[i]], modul_{vnitrni} ]
%    nula = nulovyPolynom[...]   // odpovídající nulový koeficient
%    a = Riffle[ a, nula ]       // proloží koeficienty prvkem nula
%    return redukujPolynom[ a, modul ]
%

\subsubsection{Mocnění}
Mocnění \emph{polynomů} je implementováno pomocí algoritmu
\emph{Square-and-Multiply} (\emph{SM}). Algoritmus využívá faktu, že libovolnou
mocninu lze rozložit na součin mocnin čtverců ($^2$,$^4$,$^8$,\dots). Konkrétně
byla implementována varianta provádějící výpočet od nejvíce významného bitu
exponentu\footnote{
Uváděna jako \emph{MSB} -- z anglického \emph{most significant bit}
}. Algoritmus má vstupy polynom $a$ a exponent $e$. Exponent se vyjádří jako
číslo v \emph{binární} soustavě a poté algoritmus provádí cyklus přes bity
tohoto rozvoje. V každém kroku se mezivýsledek umocní na druhou a v případě, že
je odpovídající bit exponentu $1$, přinásobí se původní číslo $a$.


\paragraph{Algoritmus:} TBA
% umocni[ a, e, modul ] :=
%     rozvoj = IntegerDigits[ e, 2 ]
%     c = a
%     for ( i in 2..Length[rozvoj] )
%         c = naDruhou[ c, modul ]
%         if ( rozvoj[[i]] == 1 )
%             c = krat[ c, a, modul ]
%     return c


\paragraph{Poznámka} Takto implementovaný algoritmus je zranitelný vůči odběrové
a časové analýze. Pro odolnou implementaci je nutné počítat násobek \emph{vždy} a
pokud je daný bit exponentu $1$, přiřadit násobek do mezi výpočtu.
Reálná implementace je tímto způsobem.

\subsection{Možná zlepšení}

% TODO
\begin{itemize}
    \item log- a antilogaritmické tabulky
    \item dělení místo inverze + násobení
\end{itemize}




\section{Ireducibilní binární Goppa kódy}

\section{McEliece}

\section{Měření}




% % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
\begin{conclusion}
        %sem napište závěr Vaší práce
\end{conclusion}




% % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% Prilohy
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

%\bibliographystyle{csn690}
%\bibliography{mybibliographyfile}
\begin{thebibliography}{99}

% články, knihy
    \bibitem{McEliece} McEliece
    \bibitem{Paar_Understanding} Understanding Cryptography
    \bibitem{Paar_Efficient}
        \uppercase{Merchan} J. G., \uppercase{Kumar} S., \uppercase{Paar} C.,
        \uppercase{Pelzl} J. \emph{Efficient Software Implementation of Finite
        Fields with Applications to Cryptography} v Acta Applicandae
        Mathematicae: An International Survey Journal on Applying Mathematics
        and Mathematical Applications, Volume 93, Numbers 1-3, pp.  3-32,
        September 2006.  Ruhr-Universitat Bochum, 2006. Dostupné online:
        \url{http://www.emsec.rub.de/research/publications/efficient-software-implementation-finite-fields-ap/}

    \bibitem{ITT} ITT

% přednášky
    \bibitem{FIT_LIN} Přednášky BI-LIN
    \bibitem{FIT_BHW} Přednášky MI-BHW
    \bibitem{FIT_MKY} Přednášky MI-MKY
    \bibitem{FIT_MPI} Přednášky MI-MPI

% software
    \bibitem{Mathematica} Wolfram Mathematica
\end{thebibliography}

\appendix

\chapter{Seznam použitých zkratek}
% \printglossaries
\begin{description}
        \item[GF] Gallois field
        %\item[TLS] Three Letter Shortcut
\end{description}

% TODO
%\chapter{Algoritmy}
%\section{ITT}
%TBA

\chapter{Obsah přiloženého CD}

%upravte podle skutecnosti

%TODO
\begin{figure}
        \dirtree{%
                .1 readme.txt\DTcomment{stručný popis obsahu CD}.
                .1 exe\DTcomment{adresář se spustitelnou formou implementace}.
                .1 src.
                .2 impl\DTcomment{zdrojové kódy implementace}.
                .2 thesis\DTcomment{zdrojová forma práce ve formátu \LaTeX{}}.
                .1 text\DTcomment{text práce}.
                .2 thesis.pdf\DTcomment{text práce ve formátu PDF}.
                .2 thesis.ps\DTcomment{text práce ve formátu PS}.
        }
\end{figure}

\end{document}

